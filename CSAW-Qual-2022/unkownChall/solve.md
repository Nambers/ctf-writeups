For summary:
Use python code to get the locked door path:
```python
from pwn import *
import random
from concurrent.futures import ThreadPoolExecutor
threadPool = ThreadPoolExecutor(max_workers=5, thread_name_prefix="test_")
Dmap = {}
print(len(Dmap))
print("map:" + str(Dmap))
exits = []
doors = []
dead_ends = []
def record(last: int, choice: int, case_id: str):
    global Dmap
    Dmap[last * 3 + (choice - 1) * 4] = int(case_id)
    
def tryOne(path: str):
    global Dmap, exits, doors, dead_ends
    lcase_id = 0
    r = remote("rev.chal.csaw.io", 5003)
    sleep(0.1)
    r.recv()
    re = ""
    for a in path:
        choice = a;
        r.sendline(str(choice).encode())
        sleep(0.3)
        re = r.recv().decode()
        if "You have encountered a door" in re:
            print("door path:" + path)
            doors.append(path)
            r.close()
            return []
        if "You have hit a dead end" in re:
            print("end path:" + path)
            dead_ends.append(path)
            r.close()
            return []
        if "You have reached the exit!" in re:
            print("exit path:" + path)
            record(lcase_id, int(choice), 0xf)
            exits.append(path)
            r.close()
            return []
        ccase_id = ""
        try:
            # current case id
            ccase_id = re.split("\n\n")[1].split("\n")[0]
            # print(ccase_id)
            record(lcase_id, int(choice), ccase_id)
            lcase_id = int(ccase_id)
        except Exception as e:
                print(re)
                print(ccase_id)
                print("map:" + str(Dmap))
                print("Door:" + str(doors))
                print("ends:" + str(dead_ends))
                print("exits:" + str(exits))
                print(len(Dmap))
                print(exits)
                r.close()
                raise e
                return []
    r.close()
    ret = []
    if len(path) < 3 or path[:-3] != "111":
        ret.append(path + "1")
    if len(path) < 3 or path[:-3] != "222":
        ret.append(path + "2")
    if len(path) < 3 or path[:-3] != "333":
        ret.append(path + "3")
    return ret
        
newPath = []
nowPath = ["1", "2", "3"]
count = 0
while count < 200:
    if len(nowPath) == 0:
        break
    print("Trying list:" + str(nowPath))
    working = []
    for a in nowPath:
        count += 1
        print("No." + str(count) + "Trying")
        working.append(threadPool.submit(tryOne, a))
    for a in working:
        re = a.result()
        for b in re:
            newPath.append(b)
    nowPath = newPath
    newPath = []
    
Dmap = dict(sorted(Dmap.items()))
doors = [*set(doors)]
dead_ends = [*set(dead_ends)]
exits = [*set(exits)]
print("map:" + str(Dmap))
print("Door:" + str(doors))
print("ends:" + str(dead_ends))
print("exits:" + str(exits))
print(len(Dmap))
```
We will get:
```
map:{0: 1, 4: 2, 6: 4, 8: 3, 10: 5, 11: 4, 12: 7, 13: 6, 14: 5, 17: 6, 21: 8, 24: 10, 25: 9, 28: 10, 31: 11, 35: 11, 37: 12, 39: 14, 41: 13, 42: 7, 44: 14, 46: 15, 50: 0}
Door:['21123233233', '131233131313', '211223131313', '232', '13122233223', '211222331313', '13123313222', '13123231123', '211223112222', '131223132113', '131232312221', '13123233232', '21122311221', '211233131313', '211123', '1313', '131232312321', '211223132113', '131223131313', '211232312222', '21122233232', '131123', '131233132113', '1312323311', '211233113', '21122313233', '21123311123', '21123311231', '131223112221', '21123311113', '21123233232', '13122313233', '21123313232', '13123233223', '21122233223', '131113', '13122313222', '211231', '2112221', '13123233222', '131233112221', '13123231231', '211223112321', '13123311221', '13123311123', '21123313223', '131233112322', '131223113', '13122313232', '131232331313', '211232312322', '131232313', '13123313232', '131221', '1312331311', '13122233232', '21123231123', '21123231231', '211232312221', '131223112321', '21123231221', '21123313222', '211221', '13122311113', '131222332113', '1312322', '131232312222', '131232332113', '21123311221', '2112222', '211223113', '21122311231', '211222313', '1312221', '21123313233', '13123311113', '1312321', '13122231123', '211223112221', '21122311113', '131222312322', '131222312321', '1312222', '131233113', '211222312322', '2112321', '211222312321', '13123233233', '233', '21122233222', '131222312222', '222', '211233112321', '131223112222', '211222312221', '131233112321', '211222312222', '131223112322', '1312231311', '223', '2112231311', '211232331313', '21123231113', '13122311221', '11', '211222332113', '13123311231', '2112223311', '131222313', '13122231231', '21122231221', '13122231221', '21122231113', '21122231123', '1312223311', '211113', '131232312322', '211233112322', '21123233223', '131231', '211233132113', '13122311123', '21122233233', '211232313', '21122231231', '13123231113', '211233112221', '2112322', '131233112222', '13122313223', '21122313232', '21122313223', '211232332113', '13122233222', '2112331311', '13123313223', '2113', '21123233222', '21122313222', '211232312321', '2112323311', '13123313233', '13122231113', '211233112222', '131222331313', '13122311231', '131222312221', '211223112322', '13123231221', '21122311123', '13122233233']
ends:['13122233221', '2112323321113', '213', '21123233213', '13122313332', '2112231321113', '13123233132', '13113', '13123311111', '131122', '2112232', '21122233213', '21122233133', '21122313212', '1312231313113', '211232312233', '2112323313121', '2112323121', '1312333', '211111', '13122313333', '13122313331', '13123231122', '1312231321113', '13123313213', '21123313323', '211233112333', '1312323313121', '13123233231', '13123233323', '21122233321', '21122231112', '13122313132', '2112233', '211222312333', '1312323321113', '2112323312', '21123311112', '13123313332', '1312323113', '13123231112', '131232312233', '21122313333', '21123313133', '21123313213', '131223112333', '13123233332', '21123233332', '1312231113', '1312323331', '2112331331', '21123233321', '131222312233', '211233112332', '1312231321121', '1312323121', '2112223313121', '2112231313121', '13122313221', '2112323313113', '332', '1312323321121', '13122233132', '1312323312', '322', '132', '13122233322', '2112231312', '21122313331', '21122233212', '2112331321121', '333', '13123233213', '21123233231', '131222312232', '1312331331', '1312331121', '1312331321113', '211232312332', '21123313321', '21123233133', '131233112233', '1312331321121', '2112231113', '13123233322', '21123231111', '211223112333', '13122231121', '133', '13123231121', '131112', '131222312332', '211223112332', '13122313231', '21122231111', '13122311122', '21122313332', '13123313331', '31', '1312223321121', '13122231111', '21122313231', '2112331313121', '211233112232', '21122313133', '21122313221', '2112223321113', '1312331113', '221', '13123233221', '13122233321', '21123233322', '21122311121', '211222312332', '21123233323', '13122233133', '21122311111', '1312331313121', '131222312333', '21122233231', '13122311111', '21123233212', '13122231112', '21123231122', '13123313333', '1312231121', '2112231321121', '2112331113', '2112223113', '211122', '13123313323', '21123231121', '2112323331', '21123313212', '131233112332', '212', '1312223121', '211222312233', '13123313221', '1312223313113', '1312231331', '21122233132', '21123313322', '1312332', '211233112233', '2112223321121', '1312223331', '13123311112', '21122231122', '21122313321', '211223112233', '12', '13123313133', '13122233323', '21123313221', '131232312232', '211112', '13122233212', '131121', '321', '13122313323', '21122231121', '21123313333', '131233112333', '13122233332', '13122313322', '2112331321113', '2112231121', '2112332', '13122311121', '1312223313121', '21123311121', '13122311112', '21122313213', '2112223313113', '21123233221', '13122313212', '13123233133', '211223112232', '211232312232', '1312223321113', '331', '131223112232', '231', '13123233212', '13123311122', '211222312232', '1312223312', '13123311121', '1312232', '21122313132', '21123311122', '131232312332', '21122311112', '1312233', '2112223121', '13123233333', '131223112332', '2112223312', '13123313321', '211121', '131232312333', '13123233331', '131233112232', '21122233322', '323', '13122313321', '13122231122', '1312331313113', '21123233333', '2112323113', '21123313132', '13122233231', '21122311122', '21122313323', '21123313332', '1312231312', '1312231313121', '2112331313113', '13123231111', '131223112233', '21122233333', '21122233221', '21123313231', '2112333', '13122233213', '21123233132', '1312323313113', '13122233333', '21122313322', '1312331312', '13121', '13123313212', '21122233331', '2112231331', '21123231112', '13123313322', '21121', '21122233332', '21123233331', '13122233331', '13122313133', '13123313231', '21113', '2112323321121', '2112331312', '211232312333', '2112331121', '131111', '21123313331', '13123233321', '13122313213', '1312223113', '2112223331', '21123311111', '2112231313113', '21122233323', '13123313132']
exits:['1312331123312', '13122312', '1312231122312', '1312223123232', '2112331123232', '2112223122312', '1312331122312', '13123312', '1312223122232', '21122312', '1312323123232', '2112323123312', '21123232', '2112331122312', '2112223122232', '13122232', '1312331123232', '1312231122232', '21123312', '1312223123312', '2112231123232', '1312323123312', '2112223123232', '2112323123232', '1312231123232', '2112231122232', '2112223123312', '2112331122232', '1312331122232', '1312231123312', '1312323122232', '2112231122312', '2112331123312', '13123232', '1312223122312', '2112323122312', '2112323122232', '2112231123312', '1312323122312', '21122232']
```


Then, use gdb localy to get all password by:
```
b *level_next+52
b *level_next+253
r
```
And then, because we have 5 possible passwords(case_id in range(100=0x64 to 105=0x68) by analyzing decompiled code from Ghidra):
`set $eax=0x64`
and in 2nd breakpoint
`x/i $eax`
and then repeat for eax=0x65 and so on.
We will get:
```
0x64 - 0xffffffffef3e2929
0x65 - 0x42b03586
0x66 - 0xffffffffb2def4fa
0x67 - 0xffffffffda13e3d6
0x68 - 0x649df323
```

Then, use the passwords to the doors path to get flag:
```python
from pwn import *
passwords = [0xffffffffef3e2929, 0x42b03586, 0xffffffffb2def4fa, 0xffffffffda13e3d6, 0x649df323]
a1 = {0: 1, 4: 2, 6: 4, 8: 3, 10: 5, 11: 4, 12: 7, 13: 6, 14: 5, 17: 6, 21: 8, 24: 10, 25: 9, 28: 10, 31: 11, 35: 11, 37: 12, 39: 14, 41: 13, 42: 7, 44: 14, 46: 15, 50: 0}
doors = ['21123233233', '131233131313', '211223131313', '232', '13122233223', '211222331313', '13123313222', '13123231123', '211223112222', '131223132113', '131232312221', '13123233232', '21122311221', '211233131313', '211123', '1313', '131232312321', '211223132113', '131223131313', '211232312222', '21122233232', '131123', '131233132113', '1312323311', '211233113', '21122313233', '21123311123', '21123311231', '131223112221', '21123311113', '21123233232', '13122313233', '21123313232', '13123233223', '21122233223', '131113', '13122313222', '211231', '2112221', '13123233222', '131233112221', '13123231231', '211223112321', '13123311221', '13123311123', '21123313223', '131233112322', '131223113', '13122313232', '131232331313', '211232312322', '131232313', '13123313232', '131221', '1312331311', '13122233232', '21123231123', '21123231231', '211232312221', '131223112321', '21123231221', '21123313222', '211221', '13122311113', '131222332113', '1312322', '131232312222', '131232332113', '21123311221', '2112222', '211223113', '21122311231', '211222313', '1312221', '21123313233', '13123311113', '1312321', '13122231123', '211223112221', '21122311113', '131222312322', '131222312321', '1312222', '131233113', '211222312322', '2112321', '211222312321', '13123233233', '233', '21122233222', '131222312222', '222', '211233112321', '131223112222', '211222312221', '131233112321', '211222312222', '131223112322', '1312231311', '223', '2112231311', '211232331313', '21123231113', '13122311221', '11', '211222332113', '13123311231', '2112223311', '131222313', '13122231231', '21122231221', '13122231221', '21122231113', '21122231123', '1312223311', '211113', '131232312322', '211233112322', '21123233223', '131231', '211233132113', '13122311123', '21122233233', '211232313', '21122231231', '13123231113', '211233112221', '2112322', '131233112222', '13122313223', '21122313232', '21122313223', '211232332113', '13122233222', '2112331311', '13123313223', '2113', '21123233222', '21122313222', '211232312321', '2112323311', '13123313233', '13122231113', '211233112222', '131222331313', '13122311231', '131222312221', '211223112322', '13123231221', '21122311123', '13122233233']
def checkPass(path:str, password: str):
    global doors, passwords
    r = remote("rev.chal.csaw.io", 5003)
    sleep(0.1)
    r.recv()
    for b in path:
        r.sendline(b.encode())
    sleep(0.5)
    r.recv()
    r.sendline(password.encode())
    sleep(0.5)
    ret = r.recv().decode()
    r.close()
    return path + " - " + password + " - " + ret
    
from concurrent.futures import ThreadPoolExecutor
threadPool = ThreadPoolExecutor(max_workers=10, thread_name_prefix="test_")
working = []
re = []
for a in doors:
    for c in passwords:
        working.append(threadPool.submit(checkPass, a, str(c)))
for a in working:
    re.append(a.result())
print([c for c in re if "wrong password" not in c])
```
We will get:
```
['21123233233 - 1118844294 - e995_6ehind_',
 '131233131313 - 18446744072415540474 - p@yw@115_i5_',
 '211223131313 - 18446744072415540474 - p@yw@115_i5_',
 '232 - 1118844294 - e995_6ehind_',
 '13122233223 - 1118844294 - e995_6ehind_',
 '211222331313 - 18446744072415540474 - p@yw@115_i5_',
 '13123313222 - 1118844294 - e995_6ehind_',
 '13123231123 - 18446744073073320918 - +he_dum6e5+_',
 '211223112222 - 1688072995 - ide@_ever!!}',
 '131223132113 - 18446744072415540474 - p@yw@115_i5_',
 '131232312221 - 1688072995 - ide@_ever!!}',
 '13123233232 - 1118844294 - e995_6ehind_',
 '21122311221 - 18446744073073320918 - +he_dum6e5+_',
 '211233131313 - 18446744072415540474 - p@yw@115_i5_',
 '211123 - 18446744073073320918 - +he_dum6e5+_',
 '1313 - 18446744072415540474 - p@yw@115_i5_',
 '131232312321 - 1688072995 - ide@_ever!!}',
 '211223132113 - 18446744072415540474 - p@yw@115_i5_',
 '131223131313 - 18446744072415540474 - p@yw@115_i5_',
 '211232312222 - 1688072995 - ide@_ever!!}',
 '21122233232 - 1118844294 - e995_6ehind_',
 '131123 - 18446744073073320918 - +he_dum6e5+_',
 '131233132113 - 18446744072415540474 - p@yw@115_i5_',
 '1312323311 - 18446744073428412713 - flag{e@5+er_',
 '211233113 - 18446744072415540474 - p@yw@115_i5_',
 '21122313233 - 1118844294 - e995_6ehind_',
 '21123311123 - 18446744073073320918 - +he_dum6e5+_',
 '21123311231 - 18446744073073320918 - +he_dum6e5+_',
 '131223112221 - 1688072995 - ide@_ever!!}',
 '21123311113 - 18446744073073320918 - +he_dum6e5+_',
 '21123233232 - 1118844294 - e995_6ehind_',
 '13122313233 - 1118844294 - e995_6ehind_',
 '21123313232 - 1118844294 - e995_6ehind_',
 '13123233223 - 1118844294 - e995_6ehind_',
 '21122233223 - 1118844294 - e995_6ehind_',
 '131113 - 18446744073073320918 - +he_dum6e5+_',
 '13122313222 - 1118844294 - e995_6ehind_',
 '211231 - 18446744073073320918 - +he_dum6e5+_',
 '2112221 - 1688072995 - ide@_ever!!}',
 '13123233222 - 1118844294 - e995_6ehind_',
 '131233112221 - 1688072995 - ide@_ever!!}',
 '13123231231 - 18446744073073320918 - +he_dum6e5+_',
 '211223112321 - 1688072995 - ide@_ever!!}',
 '13123311221 - 18446744073073320918 - +he_dum6e5+_',
 '13123311123 - 18446744073073320918 - +he_dum6e5+_',
 '21123313223 - 1118844294 - e995_6ehind_',
 '131233112322 - 1688072995 - ide@_ever!!}',
 '131223113 - 18446744072415540474 - p@yw@115_i5_',
 '13122313232 - 1118844294 - e995_6ehind_',
 '131232331313 - 18446744072415540474 - p@yw@115_i5_',
 '211232312322 - 1688072995 - ide@_ever!!}',
 '131232313 - 18446744072415540474 - p@yw@115_i5_',
 '13123313232 - 1118844294 - e995_6ehind_',
 '131221 - 18446744073073320918 - +he_dum6e5+_',
 '1312331311 - 18446744073428412713 - flag{e@5+er_',
 '13122233232 - 1118844294 - e995_6ehind_',
 '21123231123 - 18446744073073320918 - +he_dum6e5+_',
 '21123231231 - 18446744073073320918 - +he_dum6e5+_',
 '211232312221 - 1688072995 - ide@_ever!!}',
 '131223112321 - 1688072995 - ide@_ever!!}',
 '21123231221 - 18446744073073320918 - +he_dum6e5+_',
 '21123313222 - 1118844294 - e995_6ehind_',
 '211221 - 18446744073073320918 - +he_dum6e5+_',
 '13122311113 - 18446744073073320918 - +he_dum6e5+_',
 '131222332113 - 18446744072415540474 - p@yw@115_i5_',
 '1312322 - 1688072995 - ide@_ever!!}',
 '131232312222 - 1688072995 - ide@_ever!!}',
 '131232332113 - 18446744072415540474 - p@yw@115_i5_',
 '21123311221 - 18446744073073320918 - +he_dum6e5+_',
 '2112222 - 1688072995 - ide@_ever!!}',
 '211223113 - 18446744072415540474 - p@yw@115_i5_',
 '21122311231 - 18446744073073320918 - +he_dum6e5+_',
 '211222313 - 18446744072415540474 - p@yw@115_i5_',
 '1312221 - 1688072995 - ide@_ever!!}',
 '21123313233 - 1118844294 - e995_6ehind_',
 '13123311113 - 18446744073073320918 - +he_dum6e5+_',
 '1312321 - 1688072995 - ide@_ever!!}',
 '13122231123 - 18446744073073320918 - +he_dum6e5+_',
 '211223112221 - 1688072995 - ide@_ever!!}',
 '21122311113 - 18446744073073320918 - +he_dum6e5+_',
 '131222312322 - 1688072995 - ide@_ever!!}',
 '131222312321 - 1688072995 - ide@_ever!!}',
 '1312222 - 1688072995 - ide@_ever!!}',
 '131233113 - 18446744072415540474 - p@yw@115_i5_',
 '211222312322 - 1688072995 - ide@_ever!!}',
 '2112321 - 1688072995 - ide@_ever!!}',
 '211222312321 - 1688072995 - ide@_ever!!}',
 '13123233233 - 1118844294 - e995_6ehind_',
 '233 - 1118844294 - e995_6ehind_',
 '21122233222 - 1118844294 - e995_6ehind_',
 '131222312222 - 1688072995 - ide@_ever!!}',
 '222 - 1118844294 - e995_6ehind_',
 '211233112321 - 1688072995 - ide@_ever!!}',
 '131223112222 - 1688072995 - ide@_ever!!}',
 '211222312221 - 1688072995 - ide@_ever!!}',
 '131233112321 - 1688072995 - ide@_ever!!}',
 '211222312222 - 1688072995 - ide@_ever!!}',
 '131223112322 - 1688072995 - ide@_ever!!}',
 '1312231311 - 18446744073428412713 - flag{e@5+er_',
 '223 - 1118844294 - e995_6ehind_',
 '2112231311 - 18446744073428412713 - flag{e@5+er_',
 '211232331313 - 18446744072415540474 - p@yw@115_i5_',
 '21123231113 - 18446744073073320918 - +he_dum6e5+_',
 '13122311221 - 18446744073073320918 - +he_dum6e5+_',
 '11 - 18446744073428412713 - flag{e@5+er_',
 '211222332113 - 18446744072415540474 - p@yw@115_i5_',
 '13123311231 - 18446744073073320918 - +he_dum6e5+_',
 '2112223311 - 18446744073428412713 - flag{e@5+er_',
 '131222313 - 18446744072415540474 - p@yw@115_i5_',
 '13122231231 - 18446744073073320918 - +he_dum6e5+_',
 '21122231221 - 18446744073073320918 - +he_dum6e5+_',
 '13122231221 - 18446744073073320918 - +he_dum6e5+_',
 '21122231113 - 18446744073073320918 - +he_dum6e5+_',
 '21122231123 - 18446744073073320918 - +he_dum6e5+_',
 '1312223311 - 18446744073428412713 - flag{e@5+er_',
 '211113 - 18446744073073320918 - +he_dum6e5+_',
 '131232312322 - 1688072995 - ide@_ever!!}',
 '211233112322 - 1688072995 - ide@_ever!!}',
 '21123233223 - 1118844294 - e995_6ehind_',
 '131231 - 18446744073073320918 - +he_dum6e5+_',
 '211233132113 - 18446744072415540474 - p@yw@115_i5_',
 '13122311123 - 18446744073073320918 - +he_dum6e5+_',
 '21122233233 - 1118844294 - e995_6ehind_',
 '211232313 - 18446744072415540474 - p@yw@115_i5_',
 '21122231231 - 18446744073073320918 - +he_dum6e5+_',
 '13123231113 - 18446744073073320918 - +he_dum6e5+_',
 '211233112221 - 1688072995 - ide@_ever!!}',
 '2112322 - 1688072995 - ide@_ever!!}',
 '131233112222 - 1688072995 - ide@_ever!!}',
 '13122313223 - 1118844294 - e995_6ehind_',
 '21122313232 - 1118844294 - e995_6ehind_',
 '21122313223 - 1118844294 - e995_6ehind_',
 '211232332113 - 18446744072415540474 - p@yw@115_i5_',
 '13122233222 - 1118844294 - e995_6ehind_',
 '2112331311 - 18446744073428412713 - flag{e@5+er_',
 '13123313223 - 1118844294 - e995_6ehind_',
 '2113 - 18446744072415540474 - p@yw@115_i5_',
 '21123233222 - 1118844294 - e995_6ehind_',
 '21122313222 - 1118844294 - e995_6ehind_',
 '211232312321 - 1688072995 - ide@_ever!!}',
 '2112323311 - 18446744073428412713 - flag{e@5+er_',
 '13123313233 - 1118844294 - e995_6ehind_',
 '13122231113 - 18446744073073320918 - +he_dum6e5+_',
 '211233112222 - 1688072995 - ide@_ever!!}',
 '131222331313 - 18446744072415540474 - p@yw@115_i5_',
 '13122311231 - 18446744073073320918 - +he_dum6e5+_',
 '131222312221 - 1688072995 - ide@_ever!!}',
 '211223112322 - 1688072995 - ide@_ever!!}',
 '13123231221 - 18446744073073320918 - +he_dum6e5+_',
 '21122311123 - 18446744073073320918 - +he_dum6e5+_',
 '13122233233 - 1118844294 - e995_6ehind_']
```
THE FLAG~